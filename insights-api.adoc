= Red Hat Lightspeed API
:experimental: true
:product-name:

Red Hat Lightspeed allows you to investigate and make changes to the configuration of hosts managed by Red Hat through REST APIs. This cheat sheet covers the basic APIs. Refer to https://console.redhat.com/docs/api[https://console.redhat.com/docs/api] for the latest API specifications and deprecations.

NOTE: All example queries in this cheat sheet use the base endpoint: https://console.redhat.com/api/

== Table of Contents
* <<authentication,Authentication>>
** <<token-based-authentication-service-account,Red Hat token-based authentication via service account (recommended)>>
** <<api-token-based-authentication,Red Hat API token authentication>>
** <<basic-authentication,Basic authentication (deprecated)>>
* <<verify-your-setup,Verify your setup>>
** <<troubleshooting-common-failures,Troubleshooting common failures>>
* <<common-activities,Common activities>>
** <<host-inventory,Host inventory>>
** <<export-inventory,Export inventory>>
** <<workspaces,Workspaces>>
** <<image-builder,Image builder>>
** <<content-advisories,Content advisories>>
** <<repositories-templates,Repositories and templates>>
** <<advisor,Advisor>>
** <<vulnerabilities,Vulnerabilities>>
** <<compliance,Compliance>>
** <<life-cycle-roadmap,Life cycle and roadmap>>
** <<subscriptions,Subscriptions>>
** <<export-subscriptions,Export subscriptions>>
** <<remediations,Remediations>>
** <<integrations-notifications,Integrations and notifications>>
** <<runtimes-inventory,Runtimes inventory>>
* <<python-example,Python example>>
* <<ansible-example,Ansible example>>
* <<additional-resources,Additional resources>>

[[authentication]]
== Authentication

The Red Hat Lightspeed API provides secure REST services over HTTPS endpoints. This protects authentication credentials in transit.

[[token-based-authentication-service-account]]
=== Red Hat token-based authentication via service account (recommended)

. Create a new service account on the https://console.redhat.com/iam/service-accounts[Red Hat Hybrid Cloud Console]:
.. Go to https://console.redhat.com/iam/service-accounts
.. Click on Create service account.
.. Copy the generated Client ID and Client Secret.
. Add the service account to the applicable https://console.redhat.com/iam/user-access/groups[User Access Groups]. Service accounts *do not* inherit permissions from Default access groups, so you must assign them explicitly under https://console.redhat.com/iam/user-access/groups[User Access > Groups]).
. Generate an access token using Red Hat's single sign-on (SSO) service:
+
----
curl https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token \
  -d "grant_type=client_credentials" \
  -d "scope=api.console" \
  -d client_id=<client_id> \
  -d client_secret=<client_secret> 
----
. Use the returned `access_token` to authenticate API calls:
+
----
Authorization: Bearer <access_token>
----

NOTE: Access tokens are short-lived (about 15 minutes), so you need to request a new one before it expires in order to continue making authenticated calls.

[[api-token-based-authentication]]
=== Red Hat API token authentication

. Log in to the https://access.redhat.com/[Red Hat Customer Portal] with your username and password.
. Generate an offline token using https://access.redhat.com/management/api[Red Hat API Tokens] by following the instructions.
. Generate an access token, submitting the offline token generated in the previous step:
+
----
curl https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token -d grant_type=refresh_token -d client_id=rhsm-api -d refresh_token=<offline_token>
----
. Include the access token generated in the previous step in an `Authorization: Bearer` HTTP header in your request:
+
----
Authorization: Bearer <access_token>
----

Additional information about Red Hat API Token authentication can be found in the https://access.redhat.com/articles/3626371[Getting started with Red Hat APIs] KB article.

[[basic-authentication]]
=== Basic authentication (deprecated)

*Important:* Basic authentication is now deprecated. Red Hat does not support basic authorization to connect to services' APIs. Token-based authentication is recommended. More information about transitioning from basic authentication to token-based authentication via service accounts is described on the https://access.redhat.com/articles/7036194[Red Hat Customer Portal].

[[verify-your-setup]]
== Verify your setup

Before diving into the API endpoints, let's make sure your authentication is working.

Example: List the first 5 hosts in your inventory

----
curl -X GET \
  "https://console.redhat.com/api/inventory/v1/hosts?per_page=5" \
  -H "accept: application/json" \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
----

If you see a JSON response containing host data, your setup is correct and you are ready to explore more endpoints.

[[troubleshooting-common-failures]]
=== Troubleshooting common failures

If the request fails, check the following common responses:

[cols="1,2,2,2", options="header"]
|===
| HTTP Code | Meaning | Likely Cause | How to Fix

| 401 Unauthorized
| Authentication failed
| The access token is missing, expired, or invalid
| Ensure the token is still valid or generate a new token. Verify the `Authorization` header syntax: `Bearer <token>`.

| 403 Forbidden
| Access denied
| Your account or token lacks permissions for the Red Hat Lightspeed API
| Check your organization’s https://console.redhat.com/iam/user-access/groups[role-based access control] (RBAC) settings in the Red Hat Hybrid Cloud Console. Ensure the service account has the appropriate permissions.

| 404 Not Found
| Invalid endpoint
| URL typo or wrong API path
| Verify the endpoint path — for example, `/api/inventory/v1/hosts`.

| 500 Internal Server Error
| Server-side issue
| Temporary Red Hat Lightspeed API outage or internal error
| Retry later or check https://status.redhat.com[status.redhat.com].

| 502 / 503 Gateway Errors
| Platform temporarily unavailable
| Maintenance or connectivity issue
| Wait a few minutes and try again.
|===

NOTE: Use `-v` (verbose mode) with `curl` to see full request and response headers. This helps identify whether the issue is authentication, endpoint URL, or network-related.

[[common-activities]]
== Common activities

[[host-inventory]]
=== Host inventory

Get all hosts in the account:
----
GET /inventory/v1/hosts
----

NOTE: Filtering by staleness satus ensures that only relevant systems are queried (e.g., `&staleness=fresh` or `&staleness=stale`)

Get system details (e.g., after registration, using the UUID provided):
----
GET /inventory/v1/hosts/<uuid>
----

Get all facts from a system' system profile:
----
GET /inventory/v1/hosts/<uuid>/system_profile
----

NOTE: Optimize queries by specifying only the required facts using the `fields` parameter (e.g., `?fields[system_profile]=arch&fields[system_profile]=cpu_model&fields[system_profile]=os_release`)

Get hosts and retrieve system profile fields in one request:
----
GET /inventory/v1/hosts?fields[system_profile]=arch,os_release,number_of_cpus
----

Get a system’s tags:
----
GET /inventory/v1/hosts/<uuid>/tags
----

Get all hosts with a specific tag value
----
GET /inventory/v1/hosts?tags=insights-client/security=strict
----
or
----
GET /api/inventory/v1/hosts?tags=satellite/lifecycle_environment=prod
----

NOTE: Combine multiple tags in a single query by repeating the `tags=...` parameter (e.g., ?tags=satellite/lifecycle_environment=prod&tags=satellite/lifecycle_environment=stage)

Get a subset of systems (using a filter on system profile):
----
GET /inventory/v1/hosts?filter[system_profile][infrastructure_type]=virtual
----
or
----
GET /inventory/v1/hosts?filter[system_profile][operating_system][RHEL][version][eq]=8.5
----

NOTE: Combine multiple filters in a single query by repeating the `filter[...]` parameter (e.g., `?filter[system_profile][infrastructure_type]=virtual&filter[system_profile][operating_system][RHEL][version][eq]=8.5`)

Remove a system from inventory:
----
DELETE /inventory/v1/hosts/<uuid>
----

[[export-inventory]]
=== Export inventory

Initiate an export request:
----
POST /export/v1/exports
{
  "name": "Inventory Export",
  "format": "csv",
  "sources": [
    {
      "application": "urn:redhat:application:inventory", 
      "resource": "urn:redhat:application:inventory:export:systems"
    }  
  ] 
}
----

Retrieve export status request:
----
GET /exports/<export_id>/status
----

Download the generated export (as a zip file):
----
GET /exports/<export_id>
----

[[workspaces]]
=== Workspaces (Inventory groups)

Workspaces (inventory groups) can be used to organize and manage systems by environment, team, or purpose. 

List all workspaces:
----
GET /inventory/v1/groups
----

Get details for a specific workspace:
----
GET /inventory/v1/groups/<group_id>
----

Create a new workspace:
----
POST /inventory/v1/groups
{
  "name": "Production",
  "description": "All production systems"
}
----

Add systems to a workspace:
----
POST /inventory/v1/groups/<group_id>/hosts
{ "hosts": ["<system_uuid_1>", "<system_uuid_2>"] }
----

Remove a system from a workspace:
----
DELETE /inventory/v1/groups/<group_id>/hosts/<system_uuid>
----

Delete a workspace:
----
DELETE /inventory/v1/groups/<group_id>
----

Related Knowledgebase article on https://access.redhat.com/solutions/7063192[How to automate the process of assigning systems to groups/workspaces in Red Hat Lightspeed?].

[[image-builder]]
=== Image builder

Submit a new compose image request
----
POST /image-builder/v1/compose
{
  "image_name": "My latest RHEL9 guest image",
  "distribution": "rhel-95",
  "image_requests": [
    {
      "architecture": "x86_64",
      "image_type": "guest-image",
      "upload_request": {
        "type": "aws.s3",
        "options": {}
      }
    }
  ]
}
----

Get a list of compose image request IDs:
----
GET /image-builder/v1/composes/
----

Get the status of a compose image request
----
GET /image-builder/v1/composes/<compose_id>
----

Possible status values include `pending`, `building`, `success`, `failure` or `expired`.
Typical build times range from ~30 seconds (small images) to ~5 minutes (larger or multi-repository builds).

Related blog post on https://www.redhat.com/en/blog/using-hosted-image-builder-its-api[Using hosted image builder via its API].

[[content-advisories]]
=== Content advisories

Get all applicable advisories for my systems (patches available):
----
GET /patch/v3/export/advisories
----

[[repositories-templates]]
=== Repositories and templates

This section documents the `content-sources` endpoint for managing repositories and content templates in Red Hat Lightspeed.

*Managing repositories*

Get a list of all existing repositories:
----
GET /content-sources/v1.0/repositories/
----

Create a new custom repository:
----
POST /content-sources/v1.0/repositories/
{
  "distribution_arch": "x86_64",
  "distribution_versions": ["10"],
  "gpg_key": "-----BEGIN PGP PUBLIC KEY BLOCK-----\n\...\n-----END PGP PUBLIC KEY BLOCK-----",
  "metadata_verification": false,
  "module_hotfixes": false,
  "name": "EPEL 10 Everything x86_64",
  "snapshot": false,
  "url": "https://dl.fedoraproject.org/pub/epel/10/Everything/x86_64/"
}
----
NOTE: to create multiple repositories at once, use the bulk API: `POST /content-sources/v1.0/repositories/bulk_create/`

*Managing content templates*

Create a new content template
```
POST /content-sources/v1.0/templates/
{
  "arch": "x86_64",
  "description": "",
  "name": "My RHEL10 template",
  "repository_uuids": [
        "<repository1 id>",
        "<repository2 id>",
        "<repository3 id>"
  ],
  "use_latest": true,
  "version": "10"
}
```

*Assigning systems to a content template*

- *For system on RHEL 9.6 or RHEL 10 and later:*
You can assign the template at registration time:
```
rhc connect --content-template=<template_name>
```
NOTE: Assigning a system to a template will overwrite any previously assigned template.
NOTE: This method avoids the need to run `subscription-manager` separately.

- *For systems before RHEL 9.6 and RHEL 10:*
You can assign the template using the `patch` API:
```
PUT /patch/v3/templates/<template id>/systems
{
  "systems": [
    "<system1 uuid>",
    "<system2 uuid>"
  ]
}
```
NOTE: Assigning a system to a template will overwrite any previously assigned template.
The system will pick up content from your assigned content template when refreshing `subscription-manager`:
```
rhc connect
subscription-manager refresh
```

- *For all systems (without using rhc):*
Alternatively, manually download the `config.repo` repository file for your system configuration:
```
curl -o /etc/yum.repos.d/template.repo  https://cert.console.redhat.com/api/content-sources/v1/templates/<template id>/config.repo
```
NOTE: Systems consuming a template in this manner will not properly report applicable errata within Red Hat Lightspeed. The previous methods with `rhc` and `subscription-manager` are recommended.

*Updating system content*

To apply the latest content updates from the template, run: `dnf update`

[[advisor]]
=== Advisor

Get all active hits for the account:
----
GET /insights/v1/rule/
----

Get all rule hits on hosts:
----
GET /insights/v1/export/hits/
----

NOTE: Exports are available as CSV and JSON.

Get all active hits with Ansible remediation playbooks:
----
GET /insights/v1/export/hits?has_playbook=true
----

Get summary of all hits for a given system :
----
GET /insights/v1/system/<uuid>
----

[[vulnerabilities]]
=== Vulnerabilities

Get vulnerabilities affecting systems in the account:
----
GET /vulnerability/v1/vulnerabilities/cves?affecting=true
----

Get executive reports, e.g., CVEs by severity, top CVEs, etc.:
----
GET /vulnerability/v1/report/executive
----

[[compliance]]
=== Compliance

Get a list of Security Content Automation Protocol (SCAP) policies
----
GET /compliance/v2/policies
----

Get systems associated with Security Content Automation Protocol (SCAP) policies:
----
GET /compliance/v2/systems&filter=assigned_or_scanned=true
----

Associate a system to a Security Content Automation Protocol (SCAP) policy:
----
PATCH /compliance/v2/policies/<policy_id>/systems/<system_id>
----

Retrieve a list of all available compliance reports:
----
GET /compliance/v2/reports
----

Retrieve a list of affected hosts for a compliance report:
----
GET /compliance/v2/reports/<report_id>/test_results
----

Related blog post on https://www.redhat.com/en/blog/red-hat-compliance-service-and-red-hat-insights-api[Red Hat Compliance service and the Red Hat Lightspeed API].

[[life-cycle-roadmap]]
=== Life cycle and roadmap

List RHEL 9 application stream names:
----
GET /roadmap/v1/lifecycle/app-streams/9/streams
----

Show life cycle information for a specific application stream (e.g. PHP 8.2):
----
GET /roadmap/v1/lifecycle/app-streams?application_stream_name=PHP%208.2
----

Related Knowledgebase article on https://access.redhat.com/articles/7129267[How to query the Red Hat Lightspeed API for Red Hat Enterprise Linux Application Streams life cycle information?].

Show life cycle data for supported RHEL versions and end-of-life (EOL) dates:
----
GET /roadmap/v1/relevant/lifecycle/rhel
----

[[subscriptions]]
=== Subscriptions

Get all systems with a matching RHEL for x86 subscription:
----
GET /rhsm-subscriptions/v1/instances/products/RHEL%20for%20x86
----

[[export-subscriptions]]
=== Export subscriptions

Initiate an export request:
----
POST /export/v1/exports
{
  "name": "Subscriptions Export",
  "format": "csv",
  "sources": [
    {
      "application": "subscriptions", 
      "resource": "subscriptions"
    }  
  ] 
}
----

Retrieve export status request:
----
GET /exports/<export_id>/status
----

Download the generated export (as a zip file):
----
GET /exports/<export_id>
----

[[remediations]]
=== Remediations

Get a list of defined remediations:
----
GET /remediations/v1/remediations
----

Create a new remediation and assign systems:
----
POST /remediations/v1/remediations
{
  "name": "Fix Critical CVEs",
  "archived": true,
  "auto_reboot": true,
  "add": {
    "issues": [
      {
        "id": "advisor:CVE_2017_6074_kernel|KERNEL_CVE_2017_6074",
        "resolution": "mitigate",
        "systems": [
          "<uuid>"
        ]
      }
    ]
  }
}
----

NOTE: DELETE and PATCH operations are also available on `/remediations/v1/remediations/<remediation_id>`.

Get an Ansible remediation playbook:
----
GET /remediations/v1/remediations/<remediation_id>/playbook
----

Execute a remediation:
----
POST /remediations/v1/remediations/<remediation_id>/playbook_runs
----

[[integrations-notifications]]
=== Integrations and notifications

Get event log history for a list of last triggered Red Hat Lightspeed events and actions:
----
GET /notifications/v1/notifications/events?endDate=2021-11-23&limit=20&offset=0&sortBy=created%3ADESC&startDate=2021-11-09
----

Get list of configured third party integrations:
----
GET /integrations/v1/endpoints
----

Related blog post on https://www.redhat.com/en/blog/exploring-custom-collection-pulling-data-red-hat-insights-apis-event-driven-ansible[Exploring a custom collection for pulling data from Red Hat Lightspeed APIs to Event-Driven Ansible].

[[runtimes-inventory]]
=== Runtimes inventory

List all JVM instances in the account:

----
GET /runtimes-inventory-service/v1/instances
----
NOTE: to retrieve instances for a specific host only, append the following query parameter: `?hostname=<hostname>`

List all JVM instance IDs for a specific host:
----
GET /runtimes-inventory-service/v1/instance-ids?hostname=<hostname>
----

Retrieve an individual JVM instance by ID:
----
GET /runtimes-inventory-service/v1/instance?jvmInstanceId=<jvm_instance_id>
----

List all jar hashes associated with a specific JVM instance:
----
GET /runtimes-inventory-service/v1/jarhashes?jvmInstanceId=<jvm_instance_id>
----

List all EAP instances for a specific host:
----
GET /runtimes-inventory-service/v1/eap-instances?hostname=<hostname>
----

List all EAP instance IDs for a specific host:
----
GET /runtimes-inventory-service/v1/eap-instance-ids?hostname=<hostname>
----

Retrieve an individual EAP instance by ID:
----
GET /runtimes-inventory-service/v1/instance?eapInstanceId=<eap_instance_id>
----

[[python-example]]
== Python example

The following Python code retrieves an access token from Red Hat SSO and uses it to fetch Red Hat Lightspeed inventory data from its API.

----
import os
import requests

def get_access_token(client_id, client_secret, scope="api.console"):
    token_url = "https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token"
    payload = {
        "grant_type": "client_credentials",
        "scope": scope,
        "client_id": client_id,
        "client_secret": client_secret
    }
    resp = requests.post(token_url, data=payload)
    resp.raise_for_status()
    return resp.json().get("access_token")

def list_hosts(token):
    url = "https://console.redhat.com/api/inventory/v1/hosts"
    headers = {"Authorization": f"Bearer {token}"}
    resp = requests.get(url, headers=headers)
    resp.raise_for_status()
    return resp.json()

if __name__ == "__main__":
    client_id = os.environ.get("RH_CLIENT_ID")
    client_secret = os.environ.get("RH_CLIENT_SECRET")

    token = get_access_token(client_id, client_secret)
    hosts = list_hosts(token)

    print("Total hosts:", hosts.get("total"))
    print("First host entry:", hosts.get("results", [])[0])
----

[[ansible-example]]
== Ansible example

The following Ansible playbook retrieves an access token from Red Hat SSO and uses it to fetch Red Hat Lightspeed inventory data from its API.

----
---
- hosts: localhost
  connection: local
  gather_facts: no

  vars:
    client_id: "{{ lookup('env', 'RH_CLIENT_ID') }}"
    client_secret: "{{ lookup('env', 'RH_CLIENT_SECRET') }}"
    scope: "api.console"
    sso_url: "https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token"
    insights_api_url: "https://console.redhat.com/api"

  tasks:
    - name: Obtain access token
      uri:
        url: "{{ sso_url }}"
        method: POST
        body:
          grant_type: "client_credentials"
          scope: "{{ scope }}"
          client_id: "{{ client_id }}"
          client_secret: "{{ client_secret }}"
        body_format: form-urlencoded
        return_content: yes
      register: token_response

    - name: Set access token fact
      set_fact:
        access_token: "{{ token_response.json.access_token }}"

    - name: Get Inventory
      uri:
        url: "{{ insights_api_url }}/inventory/v1/hosts/"
        method: GET
        headers:
          Authorization: "Bearer {{ access_token }}"
        return_content: yes
        status_code: 200
      register: result

    - name: Display inventory
      debug:
        var: result.json
----

[[additional-resources]]
== Additional resources

* https://access.redhat.com/support/insights/faq[Red Hat Lightspeed FAQ] – Quick answers on usage, licensing, and API-access questions.
* https://access.redhat.com/support/insights[Red Hat Lightspeed – Information & Resources] – Webinars, demos, integration guides.
* https://developers.redhat.com/cheat-sheets/red-hat-insights-api-cheat-sheet[Red Hat Lightspeed API Cheat Sheet] – Latest version of this cheatsheet.
* https://docs.redhat.com/en/documentation/red_hat_insights/1-latest/html/using_the_red_hat_insights_api/index[Using the Red Hat Lightspeed API] – Overview of authentication, endpoints, and usage.
* https://console.redhat.com/docs/api[Red Hat Lightspeed API Documentation] – Full list of endpoints and supported parameters.

'''
_Last updated: November 2025_
